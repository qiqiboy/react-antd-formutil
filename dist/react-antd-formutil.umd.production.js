(function(e,r){typeof exports==="object"&&typeof module!=="undefined"?r(exports,require("react-formutil"),require("react"),require("antd")):typeof define==="function"&&define.amd?define(["exports","react-formutil","react","antd"],r):(e=e||self,r(e["react-antd-formutil"]={},e.ReactFormutil,e.React,e.antd))})(this,function(e,r,t,n){"use strict";var o="default"in t?t["default"]:t;function i(e,r,t){if(r in e){Object.defineProperty(e,r,{value:t,enumerable:true,configurable:true,writable:true})}else{e[r]=t}return e}function a(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){a=function e(r){return typeof r}}else{a=function e(r){return r&&typeof Symbol==="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r}}return a(e)}function u(e,r){if(a(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==undefined){var n=t.call(e,r||"default");if(a(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function c(e){var r=u(e,"string");return a(r)==="symbol"?r:String(r)}function f(e,r){if(e==null)return{};var t={};var n=Object.keys(e);var o,i;for(i=0;i<n.length;i++){o=n[i];if(r.indexOf(o)>=0)continue;t[o]=e[o]}return t}function s(e,r){if(e==null)return{};var t=f(e,r);var n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++){n=i[o];if(r.indexOf(n)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(e,n))continue;t[n]=e[n]}}return t}function l(e,r){if(!(e instanceof r)){throw new TypeError("Cannot call a class as a function")}}function p(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function v(e,r,t){if(r)p(e.prototype,r);if(t)p(e,t);return e}function d(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function m(e,r){if(r&&(a(r)==="object"||typeof r==="function")){return r}return d(e)}function y(e){y=Object.setPrototypeOf?Object.getPrototypeOf:function e(r){return r.__proto__||Object.getPrototypeOf(r)};return y(e)}function b(e,r){b=Object.setPrototypeOf||function e(r,t){r.__proto__=t;return r};return b(e,r)}function h(e,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:true,configurable:true}});if(r)b(e,r)}function g(e,r){return r={exports:{}},e(r,r.exports),r.exports}var S="function"===typeof Symbol&&Symbol.for,$=S?Symbol.for("react.element"):60103,P=S?Symbol.for("react.portal"):60106,j=S?Symbol.for("react.fragment"):60107,w=S?Symbol.for("react.strict_mode"):60108,O=S?Symbol.for("react.profiler"):60114,E=S?Symbol.for("react.provider"):60109,k=S?Symbol.for("react.context"):60110,C=S?Symbol.for("react.async_mode"):60111,_=S?Symbol.for("react.concurrent_mode"):60111,x=S?Symbol.for("react.forward_ref"):60112,F=S?Symbol.for("react.suspense"):60113,V=S?Symbol.for("react.suspense_list"):60120,T=S?Symbol.for("react.memo"):60115,M=S?Symbol.for("react.lazy"):60116,A=S?Symbol.for("react.block"):60121,R=S?Symbol.for("react.fundamental"):60117,N=S?Symbol.for("react.responder"):60118,L=S?Symbol.for("react.scope"):60119;function U(e){if("object"===typeof e&&null!==e){var r=e.$$typeof;switch(r){case $:switch(e=e.type,e){case C:case _:case j:case O:case w:case F:return e;default:switch(e=e&&e.$$typeof,e){case k:case x:case M:case T:case E:return e;default:return r}}case P:return r}}}function I(e){return U(e)===_}var q=C;var z=_;var D=k;var Y=E;var B=$;var H=x;var W=j;var K=M;var G=T;var J=P;var Q=O;var X=w;var Z=F;var ee=function(e){return I(e)||U(e)===C};var re=I;var te=function(e){return U(e)===k};var ne=function(e){return U(e)===E};var oe=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===$};var ie=function(e){return U(e)===x};var ae=function(e){return U(e)===j};var ue=function(e){return U(e)===M};var ce=function(e){return U(e)===T};var fe=function(e){return U(e)===P};var se=function(e){return U(e)===O};var le=function(e){return U(e)===w};var pe=function(e){return U(e)===F};var ve=function(e){return"string"===typeof e||"function"===typeof e||e===j||e===_||e===O||e===w||e===F||e===V||"object"===typeof e&&null!==e&&(e.$$typeof===M||e.$$typeof===T||e.$$typeof===E||e.$$typeof===k||e.$$typeof===x||e.$$typeof===R||e.$$typeof===N||e.$$typeof===L||e.$$typeof===A)};var de=U;var me={AsyncMode:q,ConcurrentMode:z,ContextConsumer:D,ContextProvider:Y,Element:B,ForwardRef:H,Fragment:W,Lazy:K,Memo:G,Portal:J,Profiler:Q,StrictMode:X,Suspense:Z,isAsyncMode:ee,isConcurrentMode:re,isContextConsumer:te,isContextProvider:ne,isElement:oe,isForwardRef:ie,isFragment:ae,isLazy:ue,isMemo:ce,isPortal:fe,isProfiler:se,isStrictMode:le,isSuspense:pe,isValidElementType:ve,typeOf:de};var ye=g(function(e){{e.exports=me}});var be=ye.isValidElementType;var he=Array.isArray;var ge=Object.keys;var Se=Object.prototype.hasOwnProperty;var $e=typeof Element!=="undefined";function Pe(e,r){if(e===r)return true;if(e&&r&&typeof e=="object"&&typeof r=="object"){var t=he(e),n=he(r),o,i,a;if(t&&n){i=e.length;if(i!=r.length)return false;for(o=i;o--!==0;)if(!Pe(e[o],r[o]))return false;return true}if(t!=n)return false;var u=e instanceof Date,c=r instanceof Date;if(u!=c)return false;if(u&&c)return e.getTime()==r.getTime();var f=e instanceof RegExp,s=r instanceof RegExp;if(f!=s)return false;if(f&&s)return e.toString()==r.toString();var l=ge(e);i=l.length;if(i!==ge(r).length)return false;for(o=i;o--!==0;)if(!Se.call(r,l[o]))return false;if($e&&e instanceof Element&&r instanceof Element)return e===r;for(o=i;o--!==0;){a=l[o];if(a==="_owner"&&e.$$typeof){continue}else{if(!Pe(e[a],r[a]))return false}}return true}return e!==e&&r!==r}var je=function e(r,t){try{return Pe(r,t)}catch(e){if(e.message&&e.message.match(/stack|recursion/i)||e.number===-2146828260){console.warn("Warning: react-fast-compare does not handle circular references.",e.name,e.message);return false}throw e}};var we=t.createContext({}),Oe=we.Consumer,Ee=we.Provider;var ke=1;var Ce=function e(r){ke=r};var _e=n.Switch.name!=="Switch";var xe=_e?n.Switch:"Switch";var Fe=_e?n.Checkbox:"Checkbox";var Ve=_e?n.Radio:"Radio";var Te=_e?n.Transfer:"Transfer";var Me=_e?n.Pagination:"Pagination";var Ae=_e?n.Upload:"Upload";function Re(e){if(e){var r;var t=e.type;if(typeof t!=="string"&&be(t)){if(t.formutilType){return t.formutilType}if(_e){return t}return t.displayName||t.name}return((r=e.props)===null||r===void 0?void 0:r.type)||t}}var Ne=function(e){h(a,e);function a(){var e;var r;l(this,a);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++){n[o]=arguments[o]}r=m(this,(e=y(a)).call.apply(e,[this].concat(n)));r.fields={};r.registerField=function(e,t){return t?r.fields[e]=t:delete r.fields[e]};r.latestValidationProps=null;r.checkHasError=function(e,r,t,n,o){switch(e){case 0:return r&&t&&n;case 1:return r&&t;case 2:return r;default:return false}};r.fetchCurrentValidationProps=function(e){var t=Object.keys(r.fields).map(function(e){return r.fields[e].$new()});var n=t.filter(function(e){return e.$invalid});var o=n.length>0;var i=t.some(function(e){return e.$dirty});var a=t.some(function(e){return e.$touched});var u=t.some(function(e){return e.$focused});var c=n.map(function(e){return e.$getFirstError()});return r.getValidationProps(e,o,i,a,u,c)};r.getValidationProps=function(e,t,n,o,i,a){var u=r.checkHasError(e,t,n,o,i);var c={className:[r.props.className,u&&"has-error",t?"is-invalid":"is-valid",n?"is-dirty":"is-pristine",o?"is-touched":"is-untouched",i?"is-focused":"is-unfocused"].filter(Boolean).join(" ")};if(u){Object.assign(c,{validateStatus:"error",help:a})}return c};return r}v(a,[{key:"componentDidMount",value:function e(){var r;(r=this.registerAncestorField)===null||r===void 0?void 0:r.call(this,this.props.name,this.$fieldutil)}},{key:"componentWillUnmount",value:function e(){var r;(r=this.registerAncestorField)===null||r===void 0?void 0:r.call(this,this.props.name,null)}},{key:"render",value:function e(){var a=this;var u=this.props;var f=u.children,l=u.itemProps,p=u.errorLevel,v=p===void 0?ke:p,d=u.noStyle,m=s(u,["children","itemProps","errorLevel","noStyle"]);if(!u.name){var y=this.latestValidationProps=this.fetchCurrentValidationProps(v);Promise.resolve().then(function(){if(!je(a.latestValidationProps,a.fetchCurrentValidationProps(v))){a.forceUpdate()}});return o.createElement(Ee,{value:{registerField:this.registerField}},o.createElement(n.Form.Item,Object.assign({},m,y),f))}var b=typeof f==="function"?f:t.Children.only(f);var h=Re(b);switch(h){case xe:case Fe:case Ve:m.__TYPE__="checked";break;case Me:if(!("$defaultValue"in m)){m.$defaultValue=1}break;case"checked":case"array":case"object":case"number":case"empty":m.__TYPE__=h;break;default:m.__TYPE__="empty";break}return o.createElement(r.EasyField,Object.assign({},m,{passUtil:"$fieldutil",render:function e(r){var f,p,m;var y=u.valuePropName,g=y===void 0?"value":y,S=u.changePropName,$=S===void 0?"onChange":S,P=u.focusPropName,j=P===void 0?"onFocus":P,w=u.blurPropName,O=w===void 0?"onBlur":w;var E=r.$fieldutil,k=r[$],C=r[j],_=r[O],x=r[g],F=s(r,["$fieldutil",$,j,O,g].map(c));var V=E.$invalid,T=E.$dirty,M=E.$touched,A=E.$focused,R=E.$getFirstError;var N;switch(h){case xe:case Fe:case Ve:case"checked":var L=u.checked,U=L===void 0?true:L,I=u.unchecked,q=I===void 0?false:I;N={checked:x===U,onChange:function e(r){var t=r&&r.target?r.target.checked:r;k(t?U:q,r)}};break;case Te:N={targetKeys:x,onChange:k};break;case Me:N={current:x,onChange:k};break;case Ae:N={fileList:(f=x===null||x===void 0?void 0:x.fileList)!==null&&f!==void 0?f:x,onChange:k};break;default:N=(p={onCompositionEnd:function e(r){a.isComposition=false;delete a.compositionValue;k(r)},onCompositionStart:function e(){return a.isComposition=true}},i(p,$,function(e){if(a.isComposition){a.compositionValue=e.target[g];a.forceUpdate()}else{for(var r=arguments.length,t=new Array(r>1?r-1:0),n=1;n<r;n++){t[n-1]=arguments[n]}k.apply(void 0,[e].concat(t))}}),i(p,g,"compositionValue"in a?a.compositionValue:x),p);break}Object.assign(N,(m={},i(m,j,C),i(m,O,_),m));var z=typeof b==="function"?b(N):t.cloneElement(b,N);return o.createElement(Oe,null,function(e){var r=e.registerField;if(d){a.$fieldutil=E;a.registerAncestorField=r;return z}var t=a.getValidationProps(v,V,T,M,A,R());return o.createElement(n.Form.Item,Object.assign({},F,l,t),z)})}}))}}]);return a}(t.Component);Object.keys(r).forEach(function(t){if(t!=="default")Object.defineProperty(e,t,{enumerable:true,get:function(){return r[t]}})});e.FormItem=Ne;e.setErrorLevel=Ce;Object.defineProperty(e,"__esModule",{value:true})});

import{EasyField as e}from"react-formutil";export*from"react-formutil";import t,{createContext as r,Children as n,cloneElement as o,Component as i}from"react";import{isValidElementType as a}from"react-is";import{Form as u,Pagination as c,Radio as l,Checkbox as s,Switch as f,Upload as p,Transfer as d}from"antd";import v from"react-fast-compare";function m(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function y(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){y=function e(t){return typeof t}}else{y=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return y(e)}function h(e,t){if(y(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if(y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function b(e){var t=h(e,"string");return y(t)==="symbol"?t:String(t)}function g(e,t){if(e==null)return{};var r={};var n=Object.keys(e);var o,i;for(i=0;i<n.length;i++){o=n[i];if(t.indexOf(o)>=0)continue;r[o]=e[o]}return r}function P(e,t){if(e==null)return{};var r=g(e,t);var n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++){n=i[o];if(t.indexOf(n)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(e,n))continue;r[n]=e[n]}}return r}function O(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function _(e,t,r){if(t)k(e.prototype,t);if(r)k(e,r);return e}function j(e){j=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return j(e)}function w(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function $(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function E(e,t){if(t&&(y(t)==="object"||typeof t==="function")){return t}return $(e)}function S(e){return function(){var t=j(e),r;if(w()){var n=j(this).constructor;r=Reflect.construct(t,arguments,n)}else{r=t.apply(this,arguments)}return E(this,r)}}function C(e,t){C=Object.setPrototypeOf||function e(t,r){t.__proto__=r;return t};return C(e,t)}function V(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)C(e,t)}var F=r(),T=F.Consumer,N=F.Provider;var x=1;var R=function e(t){x=t};function A(e){if(e){var t=e.type;if(a(t)){if(t.formutilType){return t.formutilType}if(typeof t==="string"&&e.props.type){return e.props.type}}return t||e}}var q=function(r){V(a,r);var i=S(a);function a(){var e;O(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}e=i.call.apply(i,[this].concat(r));e.fields={};e.registerField=function(t,r){return r?e.fields[t]=r:delete e.fields[t]};e.latestValidationProps=null;e.checkHasError=function(e,t,r,n,o){switch(e){case 0:return t&&r&&n;case 1:return t&&r;case 2:return t;default:return false}};e.fetchCurrentValidationProps=function(t){var r=Object.keys(e.fields).map(function(t){return e.fields[t].$new()});var n=r.filter(function(e){return e.$invalid});var o=n.length>0;var i=r.some(function(e){return e.$dirty});var a=r.some(function(e){return e.$touched});var u=r.some(function(e){return e.$focused});var c=n.map(function(e){return e.$getFirstError()});return e.getValidationProps(t,o,i,a,u,c)};e.getValidationProps=function(t,r,n,o,i,a){var u=e.checkHasError(t,r,n,o,i);var c={className:[e.props.className,u&&"has-error",r?"is-invalid":"is-valid",n?"is-dirty":"is-pristine",o?"is-touched":"is-untouched",i?"is-focused":"is-unfocused"].filter(Boolean).join(" ")};if(u){Object.assign(c,{validateStatus:"error",help:a})}return c};return e}_(a,[{key:"componentDidMount",value:function e(){var t;(t=this.registerAncestorField)===null||t===void 0?void 0:t.call(this,this.props.name,this.$fieldutil)}},{key:"componentWillUnmount",value:function e(){var t;(t=this.registerAncestorField)===null||t===void 0?void 0:t.call(this,this.props.name,null)}},{key:"render",value:function r(){var i=this;var a=this.props;var y=a.children,h=a.itemProps,g=a.errorLevel,O=g===void 0?x:g,k=a.noStyle,_=P(a,["children","itemProps","errorLevel","noStyle"]);if(!a.name){var j=this.latestValidationProps=this.fetchCurrentValidationProps(O);Promise.resolve().then(function(){if(!v(i.latestValidationProps,i.fetchCurrentValidationProps(O))){i.forceUpdate()}});return t.createElement(N,{value:this.registerField},t.createElement(u.Item,Object.assign({},_,j),y))}if(a.$memo===true){_.__DIFF__=y}var w=typeof y==="function"?y:n.only(y);var $=A(w);switch($){case f:case s:case l:_.__TYPE__="checked";break;case c:if(!("$defaultValue"in _)){_.$defaultValue=1}break;case"checked":case"array":case"object":case"number":case"empty":_.__TYPE__=$;break;default:_.__TYPE__="empty";break}return t.createElement(e,Object.assign({},_,{passUtil:"$fieldutil",render:function e(r){var n,v,y;var g=a.valuePropName,j=g===void 0?"value":g,E=a.changePropName,S=E===void 0?"onChange":E,C=a.focusPropName,V=C===void 0?"onFocus":C,F=a.blurPropName,N=F===void 0?"onBlur":F;var x=r.$fieldutil,R=r[S],A=r[V],q=r[N],D=r[j],I=P(r,["$fieldutil",S,V,N,j].map(b));var L=x.$invalid,U=x.$dirty,Y=x.$touched,B=x.$focused,H=x.$getFirstError;var K;switch($){case f:case s:case l:case"checked":var M=a.checked,W=M===void 0?true:M,z=a.unchecked,G=z===void 0?false:z;K={checked:D===W,onChange:function e(t){var r=t&&t.target?t.target.checked:t;R(r?W:G,t)}};break;case d:K={targetKeys:D,onChange:R};break;case c:K={current:D,onChange:R};break;case p:K={fileList:(n=D===null||D===void 0?void 0:D.fileList)!==null&&n!==void 0?n:D,onChange:R};break;default:K=(v={onCompositionEnd:function e(t){i.isComposition=false;delete i.compositionValue;R(t)},onCompositionStart:function e(){return i.isComposition=true}},m(v,S,function(e){if(i.isComposition){i.compositionValue=e.target[j];i.forceUpdate()}else{for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++){r[n-1]=arguments[n]}R.apply(void 0,[e].concat(r))}}),m(v,j,"compositionValue"in i?i.compositionValue:D),v);break}Object.assign(K,(y={},m(y,V,A),m(y,N,q),y));if(!I.required&&_.required&&(!h||!("required"in h))){I.required=true}var J=typeof w==="function"?w(K):o(w,K);return t.createElement(T,null,function(e){if(k){i.$fieldutil=x;i.registerAncestorField=e;return J}var r=i.getValidationProps(O,L,U,Y,B,H());return t.createElement(u.Item,Object.assign({},I,h,r),J)})}}))}}]);return a}(i);export{q as FormItem,R as setErrorLevel};

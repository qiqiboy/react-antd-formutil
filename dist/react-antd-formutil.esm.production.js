import{EasyField as e}from"react-formutil";export*from"react-formutil";import r from"@babel/runtime/helpers/esm/defineProperty";import t from"@babel/runtime/helpers/esm/toPropertyKey";import i from"@babel/runtime/helpers/esm/objectWithoutProperties";import o from"@babel/runtime/helpers/esm/classCallCheck";import n from"@babel/runtime/helpers/esm/createClass";import a from"@babel/runtime/helpers/esm/possibleConstructorReturn";import s from"@babel/runtime/helpers/esm/getPrototypeOf";import l from"@babel/runtime/helpers/esm/inherits";import c,{createContext as u,Children as f,cloneElement as m,Component as p}from"react";import{isValidElementType as d}from"react-is";import{Form as v,Pagination as h,Radio as b,Checkbox as g,Switch as y,Upload as P,Transfer as k}from"antd";import C from"react-fast-compare";var $=u(),V=$.Consumer,E=$.Provider;var _=1;var j=function e(r){_=r};function F(e){if(e){var r=e.type;if(d(r)){if(r.formutilType){return r.formutilType}if(typeof r==="string"&&e.props.type){return e.props.type}}return r||e}}var O=function(u){l(p,u);function p(){var e;var r;o(this,p);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++){i[n]=arguments[n]}r=a(this,(e=s(p)).call.apply(e,[this].concat(i)));r.fields={};r.registerField=function(e,t){return t?r.fields[e]=t:delete r.fields[e]};r.latestValidationProps=null;r.checkHasError=function(e,r,t,i,o){switch(e){case 0:return r&&t&&i;case 1:return r&&t;case 2:return r;default:return false}};r.fetchCurrentValidationProps=function(e){var t=Object.keys(r.fields).map(function(e){return r.fields[e].$new()});var i=t.filter(function(e){return e.$invalid});var o=i.length>0;var n=t.some(function(e){return e.$dirty});var a=t.some(function(e){return e.$touched});var s=t.some(function(e){return e.$focused});var l=i.map(function(e){return e.$getFirstError()});return r.getValidationProps(e,o,n,a,s,l)};r.getValidationProps=function(e,t,i,o,n,a){var s=r.checkHasError(e,t,i,o,n);var l={className:[r.props.className,s&&"has-error",t?"is-invalid":"is-valid",i?"is-dirty":"is-pristine",o?"is-touched":"is-untouched",n?"is-focused":"is-unfocused"].filter(Boolean).join(" ")};if(s){Object.assign(l,{validateStatus:"error",help:a})}return l};return r}n(p,[{key:"componentDidMount",value:function e(){var r;(r=this.registerAncestorField)===null||r===void 0?void 0:r.call(this,this.props.name,this.$fieldutil)}},{key:"componentWillUnmount",value:function e(){var r;(r=this.registerAncestorField)===null||r===void 0?void 0:r.call(this,this.props.name,null)}},{key:"render",value:function o(){var n=this;var a=this.props;var s=a.children,l=a.itemProps,u=a.errorLevel,p=u===void 0?_:u,d=a.noStyle,$=i(a,["children","itemProps","errorLevel","noStyle"]);if(!a.name){var j=this.latestValidationProps=this.fetchCurrentValidationProps(p);Promise.resolve().then(function(){if(!C(n.latestValidationProps,n.fetchCurrentValidationProps(p))){n.forceUpdate()}});return c.createElement(E,{value:this.registerField},c.createElement(v.Item,Object.assign({},$,j),s))}var O=typeof s==="function"?s:f.only(s);var w=F(O);switch(w){case y:case g:case b:$.__TYPE__="checked";break;case h:if(!("$defaultValue"in $)){$.$defaultValue=1}break;case"checked":case"array":case"object":case"number":case"empty":$.__TYPE__=w;break;default:$.__TYPE__="empty";break}return c.createElement(e,Object.assign({},$,{passUtil:"$fieldutil",render:function e(o){var s,u,f;var C=a.valuePropName,E=C===void 0?"value":C,_=a.changePropName,j=_===void 0?"onChange":_,F=a.focusPropName,N=F===void 0?"onFocus":F,A=a.blurPropName,T=A===void 0?"onBlur":A;var q=o.$fieldutil,L=o[j],S=o[N],U=o[T],Y=o[E],x=i(o,["$fieldutil",j,N,T,E].map(t));var B=q.$invalid,H=q.$dirty,I=q.$touched,K=q.$focused,W=q.$getFirstError;var D;switch(w){case y:case g:case b:case"checked":var M=a.checked,R=M===void 0?true:M,z=a.unchecked,G=z===void 0?false:z;D={checked:Y===R,onChange:function e(r){var t=r&&r.target?r.target.checked:r;L(t?R:G,r)}};break;case k:D={targetKeys:Y,onChange:L};break;case h:D={current:Y,onChange:L};break;case P:D={fileList:(s=Y===null||Y===void 0?void 0:Y.fileList)!==null&&s!==void 0?s:Y,onChange:L};break;default:D=(u={onCompositionEnd:function e(r){n.isComposition=false;delete n.compositionValue;L(r)},onCompositionStart:function e(){return n.isComposition=true}},r(u,j,function(e){if(n.isComposition){n.compositionValue=e.target[E];n.forceUpdate()}else{for(var r=arguments.length,t=new Array(r>1?r-1:0),i=1;i<r;i++){t[i-1]=arguments[i]}L.apply(void 0,[e].concat(t))}}),r(u,E,"compositionValue"in n?n.compositionValue:Y),u);break}Object.assign(D,(f={},r(f,N,S),r(f,T,U),f));if(!x.required&&$.required&&(!l||!("required"in l))){x.required=true}var J=typeof O==="function"?O(D):m(O,D);return c.createElement(V,null,function(e){if(d){n.$fieldutil=q;n.registerAncestorField=e;return J}var r=n.getValidationProps(p,B,H,I,K,W());return c.createElement(v.Item,Object.assign({},x,l,r),J)})}}))}}]);return p}(p);export{O as FormItem,j as setErrorLevel};

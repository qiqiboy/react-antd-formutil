(function(e,r){typeof exports==="object"&&typeof module!=="undefined"?r(exports,require("react-formutil"),require("react"),require("antd")):typeof define==="function"&&define.amd?define(["exports","react-formutil","react","antd"],r):(e=typeof globalThis!=="undefined"?globalThis:e||self,r(e.ReactAntdFormutil={},e.ReactFormutil,e.React,e.antd))})(this,(function(e,r,t,n){"use strict";function o(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}var i=o(t);function a(e,r,t){if(r in e){Object.defineProperty(e,r,{value:t,enumerable:true,configurable:true,writable:true})}else{e[r]=t}return e}var u=a;function f(e,r){return r={exports:{}},e(r,r.exports),r.exports}var c=f((function(e){function r(t){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){e.exports=r=function e(r){return typeof r}}else{e.exports=r=function e(r){return r&&typeof Symbol==="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r}}return r(t)}e.exports=r}));function s(e,r){if(c(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==undefined){var n=t.call(e,r||"default");if(c(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var l=s;function p(e){var r=l(e,"string");return c(r)==="symbol"?r:String(r)}var v=p;function d(e,r){if(e==null)return{};var t={};var n=Object.keys(e);var o,i;for(i=0;i<n.length;i++){o=n[i];if(r.indexOf(o)>=0)continue;t[o]=e[o]}return t}var y=d;function m(e,r){if(e==null)return{};var t=y(e,r);var n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++){n=i[o];if(r.indexOf(n)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(e,n))continue;t[n]=e[n]}}return t}var h=m;function b(e,r){if(!(e instanceof r)){throw new TypeError("Cannot call a class as a function")}}var g=b;function P(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function $(e,r,t){if(r)P(e.prototype,r);if(t)P(e,t);return e}var O=$;var j=f((function(e){function r(t,n){e.exports=r=Object.setPrototypeOf||function e(r,t){r.__proto__=t;return r};return r(t,n)}e.exports=r}));function w(e,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:true,configurable:true}});if(r)j(e,r)}var S=w;var _=f((function(e){function r(t){e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function e(r){return r.__proto__||Object.getPrototypeOf(r)};return r(t)}e.exports=r}));function k(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}var C=k;function x(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}var E=x;function V(e,r){if(r&&(c(r)==="object"||typeof r==="function")){return r}return E(e)}var F=V;function R(e){var r=C();return function t(){var n=_(e),o;if(r){var i=_(this).constructor;o=Reflect.construct(n,arguments,i)}else{o=n.apply(this,arguments)}return F(this,o)}}var T=R;var A=60103,M=60106,N=60107,q=60108,z=60114,L=60109,B=60110,U=60112,I=60113,D=60120,Y=60115,H=60116,K=60121,W=60122,G=60117,J=60129,Q=60131;if("function"===typeof Symbol&&Symbol.for){var X=Symbol.for;A=X("react.element");M=X("react.portal");N=X("react.fragment");q=X("react.strict_mode");z=X("react.profiler");L=X("react.provider");B=X("react.context");U=X("react.forward_ref");I=X("react.suspense");D=X("react.suspense_list");Y=X("react.memo");H=X("react.lazy");K=X("react.block");W=X("react.server.block");G=X("react.fundamental");J=X("react.debug_trace_mode");Q=X("react.legacy_hidden")}function Z(e){if("object"===typeof e&&null!==e){var r=e.$$typeof;switch(r){case A:switch(e=e.type,e){case N:case z:case q:case I:case D:return e;default:switch(e=e&&e.$$typeof,e){case B:case U:case H:case Y:case L:return e;default:return r}}case M:return r}}}var ee=L,re=A,te=U,ne=N,oe=H,ie=Y,ae=M,ue=z,fe=q,ce=I;var se=B;var le=ee;var pe=re;var ve=te;var de=ne;var ye=oe;var me=ie;var he=ae;var be=ue;var ge=fe;var Pe=ce;var $e=function(){return!1};var Oe=function(){return!1};var je=function(e){return Z(e)===B};var we=function(e){return Z(e)===L};var Se=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===A};var _e=function(e){return Z(e)===U};var ke=function(e){return Z(e)===N};var Ce=function(e){return Z(e)===H};var xe=function(e){return Z(e)===Y};var Ee=function(e){return Z(e)===M};var Ve=function(e){return Z(e)===z};var Fe=function(e){return Z(e)===q};var Re=function(e){return Z(e)===I};var Te=function(e){return"string"===typeof e||"function"===typeof e||e===N||e===z||e===J||e===q||e===I||e===D||e===Q||"object"===typeof e&&null!==e&&(e.$$typeof===H||e.$$typeof===Y||e.$$typeof===L||e.$$typeof===B||e.$$typeof===U||e.$$typeof===G||e.$$typeof===K||e[0]===W)?!0:!1};var Ae=Z;var Me={ContextConsumer:se,ContextProvider:le,Element:pe,ForwardRef:ve,Fragment:de,Lazy:ye,Memo:me,Portal:he,Profiler:be,StrictMode:ge,Suspense:Pe,isAsyncMode:$e,isConcurrentMode:Oe,isContextConsumer:je,isContextProvider:we,isElement:Se,isForwardRef:_e,isFragment:ke,isLazy:Ce,isMemo:xe,isPortal:Ee,isProfiler:Ve,isStrictMode:Fe,isSuspense:Re,isValidElementType:Te,typeOf:Ae};var Ne=f((function(e){{e.exports=Me}}));var qe=typeof Element!=="undefined";var ze=typeof Map==="function";var Le=typeof Set==="function";var Be=typeof ArrayBuffer==="function"&&!!ArrayBuffer.isView;function Ue(e,r){if(e===r)return true;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return false;var t,n,o;if(Array.isArray(e)){t=e.length;if(t!=r.length)return false;for(n=t;n--!==0;)if(!Ue(e[n],r[n]))return false;return true}var i;if(ze&&e instanceof Map&&r instanceof Map){if(e.size!==r.size)return false;i=e.entries();while(!(n=i.next()).done)if(!r.has(n.value[0]))return false;i=e.entries();while(!(n=i.next()).done)if(!Ue(n.value[1],r.get(n.value[0])))return false;return true}if(Le&&e instanceof Set&&r instanceof Set){if(e.size!==r.size)return false;i=e.entries();while(!(n=i.next()).done)if(!r.has(n.value[0]))return false;return true}if(Be&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(r)){t=e.length;if(t!=r.length)return false;for(n=t;n--!==0;)if(e[n]!==r[n])return false;return true}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();o=Object.keys(e);t=o.length;if(t!==Object.keys(r).length)return false;for(n=t;n--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[n]))return false;if(qe&&e instanceof Element)return false;for(n=t;n--!==0;){if((o[n]==="_owner"||o[n]==="__v"||o[n]==="__o")&&e.$$typeof){continue}if(!Ue(e[o[n]],r[o[n]]))return false}return true}return e!==e&&r!==r}var Ie=function e(r,t){try{return Ue(r,t)}catch(e){if((e.message||"").match(/stack|recursion/i)){console.warn("react-fast-compare cannot handle circular refs");return false}throw e}};var De=Ne.isValidElementType;var Ye=t.createContext(),He=Ye.Consumer,Ke=Ye.Provider;var We=1;var Ge=function e(r){We=r};var Je=n.Select.name!=="Select";var Qe=Je?n.Switch:"Switch";var Xe=Je?n.Checkbox:"Checkbox";var Ze=Je?n.Radio:"Radio";var er=Je?n.Transfer:"Transfer";var rr=Je?n.Pagination:"Pagination";var tr=Je?n.Upload:"Upload";var nr=Je?n.Select:"Select";function or(e){if(e){var r=e.type;if(De(r)){if(r.formutilType){return r.formutilType}if(typeof r==="string"&&e.props.type){return e.props.type}if(!Je){return r.displayName||r.name||r}}return r||e}}var ir=function(e){S(a,e);var o=T(a);function a(){var e;g(this,a);for(var r=arguments.length,t=new Array(r),n=0;n<r;n++){t[n]=arguments[n]}e=o.call.apply(o,[this].concat(t));e.fields={};e.registerField=function(r,t){return t?e.fields[r]=t:delete e.fields[r]};e.latestValidationProps=null;e.checkHasError=function(e,r,t,n,o){switch(e){case 0:return r&&t&&n;case 1:return r&&t;case 2:return r;default:return false}};e.fetchCurrentValidationProps=function(r){var t=Object.keys(e.fields).map((function(r){return e.fields[r].$new()}));var n=t.filter((function(e){return e.$invalid}));var o=n.length>0;var i=t.some((function(e){return e.$dirty}));var a=t.some((function(e){return e.$touched}));var u=t.some((function(e){return e.$focused}));var f=n.map((function(e){return e.$getFirstError()}));return e.getValidationProps(r,o,i,a,u,f)};e.getValidationProps=function(r,t,n,o,i,a){var u=e.checkHasError(r,t,n,o,i);var f={className:[e.props.className,u&&"has-error",t?"is-invalid":"is-valid",n?"is-dirty":"is-pristine",o?"is-touched":"is-untouched",i?"is-focused":"is-unfocused"].filter(Boolean).join(" ")};if(u){Object.assign(f,{validateStatus:"error",help:a})}return f};return e}O(a,[{key:"componentDidMount",value:function e(){var r;(r=this.registerAncestorField)===null||r===void 0?void 0:r.call(this,this.props.name,this.$fieldutil)}},{key:"componentWillUnmount",value:function e(){var r;(r=this.registerAncestorField)===null||r===void 0?void 0:r.call(this,this.props.name,null)}},{key:"render",value:function e(){var o=this;var a=this.props;var f=a.children,c=a.itemProps,s=a.errorLevel,l=s===void 0?We:s,p=a.noStyle,d=h(a,["children","itemProps","errorLevel","noStyle"]);if(!a.name){var y=this.latestValidationProps=this.fetchCurrentValidationProps(l);Promise.resolve().then((function(){if(!Ie(o.latestValidationProps,o.fetchCurrentValidationProps(l))){o.forceUpdate()}}));return i["default"].createElement(Ke,{value:this.registerField},i["default"].createElement(n.Form.Item,Object.assign({},d,y),typeof f==="function"?f():f))}if(a.$memo===true){d.__DIFF__=f}var m=typeof f==="function"?f:t.Children.only(f);var b=or(m);switch(b){case Qe:case Xe:case Ze:d.__TYPE__="checked";break;case rr:if(!("$defaultValue"in d)){d.$defaultValue=1}break;case"checked":case"array":case"object":case"number":case"empty":d.__TYPE__=b;break;default:d.__TYPE__="empty";break}return i["default"].createElement(r.EasyField,Object.assign({},d,{passUtil:"$fieldutil",render:function e(r){var f,s,y;var g=a.valuePropName,P=g===void 0?"value":g,$=a.changePropName,O=$===void 0?"onChange":$,j=a.focusPropName,w=j===void 0?"onFocus":j,S=a.blurPropName,_=S===void 0?"onBlur":S;var k=r.$fieldutil,C=r[O],x=r[w],E=r[_],V=r[P],F=h(r,["$fieldutil",O,w,_,P].map(v));var R=k.$invalid,T=k.$dirty,A=k.$touched,M=k.$focused,N=k.$getFirstError;var q;switch(b){case Qe:case Xe:case Ze:case"checked":var z=a.checked,L=z===void 0?true:z,B=a.unchecked,U=B===void 0?false:B;q={checked:V===L,onChange:function e(r){var t=r&&r.target?r.target.checked:r;C(t?L:U,r)}};break;case er:q={targetKeys:V,onChange:C};break;case rr:q={current:V,onChange:C};break;case tr:q={fileList:(f=V===null||V===void 0?void 0:V.fileList)!==null&&f!==void 0?f:V,onChange:C};break;default:q=(s={onCompositionEnd:function e(r){o.isComposition=false;delete o.compositionValue;C(r)},onCompositionStart:function e(){return o.isComposition=true}},u(s,O,(function(e){if(o.isComposition){var r,t;o.compositionValue=(r=(t=e.target)===null||t===void 0?void 0:t[P])!==null&&r!==void 0?r:e;o.forceUpdate()}else{for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++){i[a-1]=arguments[a]}C.apply(void 0,[e].concat(i))}})),u(s,P,"compositionValue"in o?o.compositionValue:V),u(s,_,(function(){if(o.isComposition){o.isComposition=false;delete o.compositionValue;C.apply(void 0,arguments)}return E.apply(void 0,arguments)})),s);break}if(b===nr){delete q.onCompositionStart;delete q.onCompositionEnd}q=Object.assign((y={},u(y,w,x),u(y,_,E),y),q);if(!F.required&&d.required&&(!c||!("required"in c))){F.required=true}var I=typeof m==="function"?m(q):t.cloneElement(m,q);return i["default"].createElement(He,null,(function(e){if(p){o.$fieldutil=k;o.registerAncestorField=e;return I}var r=o.getValidationProps(l,R,T,A,M,N());return i["default"].createElement(n.Form.Item,Object.assign({},F,c,r),I)}))}}))}}]);return a}(t.Component);Object.keys(r).forEach((function(t){if(t!=="default")Object.defineProperty(e,t,{enumerable:true,get:function(){return r[t]}})}));e.FormItem=ir;e.setErrorLevel=Ge;Object.defineProperty(e,"__esModule",{value:true})}));
